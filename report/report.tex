%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Stylish Article
% LaTeX Template
% Version 2.2 (2020-10-22)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Mathias Legrand (legrand.mathias@gmail.com) 
% With extensive modifications by:
% Vel (vel@latextemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[fleqn, 10pt]{SelfArx} % Document font size and equations flushed left

\usepackage[english]{babel} % Specify a different language here - english by default

\usepackage{lipsum} % Required to insert dummy text. To be removed otherwise

\graphicspath{ {./images/} } % Paths were images are taken

%----------------------------------------------------------------------------------------
%	COLUMNS
%----------------------------------------------------------------------------------------

\setlength{\columnsep}{0.55cm} % Distance between the two columns of text
\setlength{\fboxrule}{0.75pt} % Width of the border around the abstract

%----------------------------------------------------------------------------------------
%	COLORS
%----------------------------------------------------------------------------------------

\definecolor{color1}{RGB}{0,0,90} % Color of the article title and sections
\definecolor{color2}{RGB}{0,20,20} % Color of the boxes behind the abstract and headings

%----------------------------------------------------------------------------------------
%	HYPERLINKS
%----------------------------------------------------------------------------------------

\usepackage{hyperref} % Required for hyperlinks

\hypersetup{
	hidelinks,
	colorlinks,
	breaklinks=true,
	urlcolor=color2,
	citecolor=color1,
	linkcolor=color1,
	bookmarksopen=false,
	pdftitle={Title},
	pdfauthor={Author},
}

%----------------------------------------------------------------------------------------
%	ARTICLE INFORMATION
%----------------------------------------------------------------------------------------

\JournalInfo{\today} % Journal information
\Archive{\textcopyright 2021-22, v.1.0} % Additional notes (e.g. copyright, DOI, review/research article)

\PaperTitle{DDoS attack through mDNS} % Article title

\Authors{A. Al Masoud\textsuperscript{1}, F. Amato\textsuperscript{2}, A. Blindu\textsuperscript{3}, D. Lotito\textsuperscript{4}, D. Ragusa\textsuperscript{5}} % Authors
\affiliation{\textsuperscript{1}\textit{Department of Computer Engineering, University of Pavia, Pavia, Italy}} % Author affiliation
\affiliation{\textbf{Corresponding author}: francesco.amato01@universitadipavia.it} % Corresponding author

\Keywords{DDoS -- mDNS -- Security -- Enterprise Digital Infrastructure} % Keywords - if you don't want any simply remove all the text between the curly brackets
\newcommand{\keywordname}{Keywords} % Defines the keywords heading name

%----------------------------------------------------------------------------------------
%	ABSTRACT
%----------------------------------------------------------------------------------------

\Abstract{Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing vitae, felis. Curabitur dictum gravida mauris. Nam arcu libero, nonummy eget, consectetuer id, vulputate a, magna. Donec vehicula augue eu neque. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Mauris ut leo. Cras viverra metus rhoncus sem. Nulla et lectus vestibulum urna fringilla ultrices. Phasellus eu tellus sit amet tortor gravida placerat. Integer sapien est, iaculis in, pretium quis, viverra ac, nunc. Praesent eget sem vel leo ultrices bibendum. Aenean faucibus. Morbi dolor nulla, malesuada eu, pulvinar at, mollis ac, nulla. Curabitur auctor semper nulla. Donec varius orci eget risus. Duis nibh mi, congue eu, accumsan eleifend, sagittis quis, diam. Duis eget orci sit amet orci dignissim rutrum.}

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle % Output the title and abstract box

\tableofcontents % Output the contents section

\thispagestyle{empty} % Removes page numbering from the first page

%----------------------------------------------------------------------------------------
%	ARTICLE CONTENTS
%----------------------------------------------------------------------------------------

\section*{Introduction} % The \section*{} command stops section numbering

\addcontentsline{toc}{section}{Introduction} % Adds this section to the table of contents

The idea for this project is to perform a Distributed Denial Of Service attack (DDoS) using the Multicast Domain Name System (mDNS).\\
For those who are not familiar with these concepts, a brief discussion about DDoS and its principles is explained below.
A DDoS attack is when an attacker is attempting to make it impossible for a target service, or multiple services, to be properly delivered.\\
In this types of attacks, itâ€™s one system that is sending the malicious data or requests; a DDoS attack comes from multiple systems.\\
Generally, these attacks work by overwhelming a system with requests for data. This could be sending a web server so many requests to serve a page that it crashes under the demand, or small requests that are amplificated by providing a huge response. \\ The result is that available internet bandwidth and the resources of the target system become overloaded.\\
In this project mDNS has been exploited in order to perform a DDoS attack. The starting hypothesis is that the botmaster and its malicious devices are within the same network of the target. In order to overload the network the attacker sends a query in multicast to all the devices inside the network according to the mDNS protocol. \\ The devices respond in multicast and the result is that the network availability, its bandwith and the mDNS service are compromised. \\
In order to understand how we exploited the mDNS for the DDoS attack, an explanation of how this protocol works is provied below.

%------------------------------------------------

\section{mDNS protocol}
Multicast DNS (mDNS) is a service that aims to solve name resolution in smaller networks. It takes a different approach than the well-known DNS: instead of sending requests to a name server, the network participants are all contacted directly.
The corresponding client sends a multicast into the network and asks which network participant the host name corresponds to. \\
In this way, the request also reaches the member of the group that has the searched hostname. This responds to the entire network, again via multicast. Moreover, all participants are informed about the name and IP address connection and can make a corresponding entry in their mDNS cache. \\
Multicast DNS causes relatively high traffic, but actively tries to conserve network resources: to this end, the requesting client sends the correct response according to its opinion (i.e. according to the current cache entry). \\ Only if this is no longer correct, or if the entry is about to expire, does the recipient have to respond. \\
In general, only hostnames ending with {\it{.local}} can be used with Multicast DNS.
The mDNS was developed in the context of Zeroconf (Zero Configuration Networking) using essentially the same programming interfaces, packet formats, and operating semantics as the unicast Domain Name Service (DNS). The idea behind Zero Configuration Networking is to allow computers to communicate with each other without the need for prior configuration.\\
It makes use of UDP packets and its implementation is described in RFC 6762 \cite{rfc6762}.\\
A popular implementation of mDNS is Bonjour by Apple, also the open source software Avahi can now be used as an mDNS service. As of Windows 10, mDNS is also available in Microsoft's operating system.

\paragraph{Advantages} 
\begin{itemize}[leftmargin=*]
    \item Since all devices share their IP addresses, there is no need to configure a server or directory. This makes it possible to add additional devices very dynamically and quickly.
\end{itemize}

\paragraph{Disadvantages} 
\begin{itemize}[leftmargin=*]
    \item One problem lies in the Multicast procedure itself. Although the protocol tries to keep network traffic low, participating computers must constantly monitor the network and process incoming messages. This requires computing power.
    \item Assigning host names is problematic: since you can freely choose a name for each device, as long as it ends in {\it{.local}}, this can (at least theoretically) lead to two network devices with the same host name.
The developers of mDNS have deliberately not proposed a solution to this problem. On the one hand, it is assumed that the case rarely occurs; on the other hand, the double naming may be intentional. Also, by default, mDNS only resolves hostnames that end with the {\it{.local}} top-level domain. This can cause problems if {\it{.local}} includes hosts that do not implement mDNS but can be found via a conventional unicast DNS server. Resolving such conflicts requires network configuration changes that mDNS is designed to avoid.
    \item In some cases, mDNS is open. This means that it also responds to requests from outside (the Internet). Attackers can find such open services and use them for DDoS attacks, using network devices improperly and targeting a server. In addition, in a DNS Multicast even sensitive data can be detected (cleartext). This allows attackers to know information about connected devices and use it for further attacks.
\end{itemize}

\subsection{Packets structure}
An mDNS message is a UDP packet sent in multicast using the following addressing:
\begin{itemize}[leftmargin=*]
    \item IPv4 address 224.0.0.251 or IPv6 address ff02::fb
    \item UDP port 5353
    \item When using Ethernet frames, the standard IP multicast MAC address 01:00:5E:00:00:FB (for IPv4) or 33:33:00:00:FB (for IPv6)
\end{itemize}
The payload structure is based on the unicast DNS packet format, which consists of two parts: the header and the data.\\
The header is identical to the one found in the unicast DNS, as are the subsections in the data part: queries, responses, authoritative-nameservers, and additional records. The number of records in each subsection corresponds to the value of the corresponding {\it{*COUNT}} field in the header.

\paragraph{Queries}
The format of the records in the query section is a bit different from that of classic DNS by adding a single-bit UNICAST-RESPONSE field.

\paragraph{Resource records}




%------------------------------------------------

\section{Results and Discussion}

\lipsum[10] % Dummy text

\subsection{Subsection}

\lipsum[11] % Dummy text

\begin{table}[hbt]
	\caption{Table of Grades}
	\centering
	\begin{tabular}{llr}
		\toprule
		\multicolumn{2}{c}{Name} \\
		\cmidrule(r){1-2}
		First name & Last Name & Grade \\
		\midrule
		John & Doe & $7.5$ \\
		Richard & Miles & $2$ \\
		\bottomrule
	\end{tabular}
	\label{tab:label}
\end{table}

\subsubsection{Subsubsection}

\lipsum[12] % Dummy text

\subsubsection{Subsubsection}

\lipsum[13] % Dummy text

\begin{itemize}[noitemsep] % [noitemsep] removes whitespace between the items for a compact look
	\item First item in a list
	\item Second item in a list
	\item Third item in a list
\end{itemize}

\subsubsection{Subsubsection}

\lipsum[14] % Dummy text

\subsection{Subsection}

\lipsum[15-23] % Dummy text

%------------------------------------------------

\phantomsection
\section*{Acknowledgments} % The \section*{} command stops section numbering

\addcontentsline{toc}{section}{Acknowledgments} % Adds this section to the table of contents

So long and thanks for all the fish \cite{Figueredo:2009dg, Smith:2012qr}.

%----------------------------------------------------------------------------------------
%	REFERENCE LIST
%----------------------------------------------------------------------------------------

\phantomsection
\bibliographystyle{unsrt}
\bibliography{mybibl.bib}

%----------------------------------------------------------------------------------------

\end{document}
